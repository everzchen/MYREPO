---
title: "01-assignment_chen.Rmd"
author: "Evelyn Chen"
date: "8/24/2019"
output: 
  html_document: default
---
## Hello, World!
The following command prints, "Hello, world!"
```{r}
print("Hello, world!")
```

## Installing Libraries
Installing the necessary libraries - tidyverse

```{r}
library(tidyverse)
```

```{r  include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(plotly)
library(Metrics)
```

##Load Data
```{r load_data}
load("college.Rdata")
```

## List of variables in the `college.Rdata` dataset:

*Variable Name* :*Definition*

instnm: Institution Name

stabbr: State Abbreviation

year: Year

control: control of institution, 1=public, 2= private non-profit, 3=private for-profit

preddeg: predominant degree, 1= certificate, 2= associates, 3= bachelor's, 4=graduate

adm_rate: Proportion of Applicants Admitted

sat_avg: Midpoint of entrance exam scores, on SAT scale, math and verbal only

costt_4a: Average cost of attendance (tuition and room and board less all grant aid)

debt_mdn: Median debt of graduates

md_earn_wne_p6: Earnings of graduates who are not enrolled in higher education, six years after graduation

ugds: number of undergraduates

## Homework Questions
## Question 1. Calculate the average earnings for individuals at the most selective and least selective colleges in the dataset.

The following code filters for schools whose admission rate is greater than 30%, a condition we deem appropriate for schools being the least selective. Within those schools, I tasked Rstudio to create a variable that calculated the average earnings of graduates, six years after graduation.

Then, I selected the schools whose admission rates is less than 10%, signifying that these schools are the most selective. Within this group of schools, Rstudio created a variable that calculated the average earnings of graduates, six years after graduation.

```{r}
## What's the average earnings for individuals at the least selective schools?
sc%>%filter(adm_rate>.3)%>%summarize(md_earn_wne_p6=mean(md_earn_wne_p6,na.rm=TRUE))

## What's the average earnings for individuals at the most selective schools?
sc%>%filter(adm_rate<.1)%>%summarize(md_earn_wne_p6=mean(md_earn_wne_p6,na.rm=TRUE))
```
Answer: The average earnings for individuals at the most and least selective colleges is 53500 and 34747, respectively.

## Question 2. Determine whether colleges with very high SAT scores tend to be larger or smaller than colleges with low SAT scores

College size can be interpreted using the variable, ugds, the number of undergraduates. Dell'Arte International School of Physical Theatre has the smallest undergraduate program of only 27 students.  Florida International University has the largest number of undergraduates, 30,920 students. To determine if colleges with high SAT scores tend to be larger or smaller than colleges with low SAT scores, I decided to create a scatterplot graphic to examine the relationship between school size and average SAT score.

The following code, ggplot, will create a graphics object. I will name it gg. Within this, I declare the dataset ('sc') the x variable ('sat_avg') and the y variable ('ugds'). I will also note that I want to use the institutional name ('instnm') as text. The last couple lines of code makes this scatterplot interactive, which makes it possible to put a mouse cursor over a particular point and see what university it corresponds to.

```{r}
gg<-ggplot(data=sc, aes(x=sat_avg,y=ugds,text=instnm))
gg<-gg+geom_point(alpha=.5,size=.5)
gg<-gg+xlab("Average SAT")+ylab("Number of Undergraduates")
gg<-gg+ggtitle("Median Student Debt and Average Cost of Tuition")
gg
gg_p<-ggplotly(gg)
gg_p
```

The scatterplot allows me to holistically see, in our dataset, to what extent average SAT score influenced the size of college. From this, I decided to filter the dataset, selecting for those universities with the highest SAT scores and the lowest SAT scores. Seeing the scatterplot allowed me to confidently assign that colleges with the highest SAT scores are those whose SAT scores are greater than 1400. Colleges with the lowest SAT scores are those whose SAT scores is less than 900. 

```{r}
sc%>%filter(sat_avg>1400)%>%select(instnm,sat_avg,ugds)%>%arrange(-ugds)

```

Of the 20 colleges whose average SAT scores is higher than 1400, most have a fairly high number of undergraduate students - 11 of them have more than 6000 undergraduate students. California Institute of Technology is unlike the rest, in that it only enrolls 951 undergraduate students. 

```{r}
sc%>%filter(sat_avg<900)%>%select(instnm,sat_avg,ugds)%>%arrange(-ugds)
```

Of the 11 colleges whose average SAT scores is lower than 900, ten of them have less than 5000 undergraduate students. Overall, when comparing schools with very high and very low SAT scores, it appears that colleges with very high SAT scores (greater than 1400) tend to be larger in school size. 

Based on a previous email exchange with Professor Bolton, I would like to answer this question with a slightly different approach. The institution's admission rate can serve as a proxy for college size. The rationale behind this is that an institution with a higher admission rate will have more students enrolled. Institutions who are more selective and have a lower admission rate will have fewer students enrolled. The following code is used to filter for institutions with a high admission rate (greater than 0.35).

```{r}
sc%>%filter(sat_avg>1400)%>%select(instnm,sat_avg,adm_rate)%>%arrange(-adm_rate)
sc%>%filter(sat_avg<900)%>%select(instnm,sat_avg,adm_rate)%>%arrange(-adm_rate)
```
It is not easy to conclude whether institutions with high SAT scores tend to be larger or smaller, when we use admission rate as a proxy for school size. Of the 20 universities whose average SAT score is higher than 1400, half of them have an admission rate greater than 0.20 and half have an admission rate lower than 0.20. Of the 11 institutions whose average SAT scores is lower than 900, all of their admission rate ranges from 0.24 to 0.38. Is is likely that institutions with low average SAT scores will have a higher admission rate, so it's possible that their school size is also larger. 

## Question 3. Plot the relationship between cost and debt. What do you see? Does this surprise you?

To examine the relationship between the cost of attendance and median student debt, I will use the following code, ggplot, to create a graphics object. Using the dataset ('sc') the x variable ('debt_mdn') and the y variable ('costt4_a'). I will also note that I want to use the institutional name ('instnm') as text. The last couple lines of code makes this scatterplot interactive, which makes it possible to put a mouse cursor over a particular point and see what university it corresponds to. This graphic is stored as "gg1."

```{r}
gg<-ggplot(data=sc, aes(x=costt4_a,y=debt_mdn,text=instnm))
gg<-gg+geom_point(alpha=.5,size=.5)
gg<-gg+xlab("Average Cost of Attendance")+ylab("Median Debt of Graduates")
gg
gg_p<-ggplotly(gg)
gg_p
gg1<-gg_p
```
On first impression, one might presume that if the average cost of attendance is higher, then the median debt of graduates will also be higher. The scatterplot demonstrates that to some extent. Several universities whose average cost of attendance is in the range of 50k has the highest median debt of graduates, around 16k to 17k. In fact, the majority of graduates with median debt of less than 15,000 dollars receive a diploma from schools whose average cost of attendance is 40,000 dollars or less. Furthermore, schools with the least average cost of attendance, around 10,000 dollars have the smallest median of debt. In examining the extremes, schools with the highest and lowest average cost of attendnce, their graduates have the highest and lowest median debt, respectively. This aligns with my initial assumptions. 

There are a couple elements in the scatterplot that surprise me. First, I did not expect there to be such a wide range of median debt among the universities whose average cost of attendance was around 50,000. For example, the average cost of attending Harvard University is 50,250 but the median debt of its graduates is only 6000. Yet, students who graduate from the California Institute of the Arts, whose average cost of attendance is 48,784, finish with a median debt of 18187.5. It would be interesting to explore to what extent their graduates were given grants and scholarships to support their educational expenses, but this information was not provided in the current dataset.

Second, I did not anticipate schools whose average cost of attendance is between 13,000 - 35,000 dollars to have graduates with such a similar median debt amount. It baffles me to think that graduates from Albany State University to have a median debt similar to graduates from Rocky Mountain of Art and Design, even though the average cost of attending Rocky Mountain of Art and Design is almost 21,000 dollars more expensive than Albany State University.

## Question 4. Provide separate plots for cost and debt by control of the institution.

The dataset includes three types of institutions, public, private non-profit and private for-profit. This characteristic is classified under the variable ('control').

control: control of institution, 1=public, 2= private non-profit, 3=private for-profit

The following code will tell me how many public, private non-profit, and private for-profit schools there are in this dataset.

```{r}
table(sc$control)
```
There are 35 public, 83 private non-profit, and 7 private for-profit schools in this dataset.

I am interested in examining the relationship between average cost of attendance and median debt of graduates for the public institutions, only. To do this, I have to use both the 'filter' and 'select' commands. I first select only public institutions. Within that, I select the average cost of attendance and median debt of graduates. The data is presented in desending order of cost. This subset of data is stored as 'public.'

```{r}
sc%>%filter(control=="1")%>%
  select(instnm,costt4_a,debt_mdn)%>%arrange(-costt4_a)
Public <- sc%>%filter(control=="1")%>%select(instnm,debt_mdn,costt4_a)
```

There are 35 public institutions in the dataset. This information can be visually shown in a scatterplot. The following code uses the command ggplot to create a graphics object. Layering this with "geom_point" tells the program to present a scatterplot. The image is stored as "gg_pub" for later use.

```{r}
gg<-ggplot(data=Public,aes(x=costt4_a,y=debt_mdn,text=instnm))
gg<-gg+geom_point(alpha=.5,size=.5)
gg<-gg+xlab("Average Cost of Attendance")+ylab("Median Debt")
gg<-gg+ggtitle("Debt and Cost in Public Universities")
gg
gg_pub <-gg
```

The scatterplot above demonstrates a positive relationship between average cost of attendance and median debt in the 35 universities. 

I am now interested in examining the relationship cost and debt of graduates for the private non-profit institutions, only. The following code filters for private non-profit institutions, saves it as a separate dataset named 'privatenp.' The ggplot command will use only the data from this group of 83 schools to create a scatterplot graphics object. 

```{r}
sc%>%filter(control=="2")%>%
  select(instnm,costt4_a,debt_mdn)%>%arrange(-costt4_a)
privatenp <- sc%>%filter(control=="2")%>%select(instnm,debt_mdn,costt4_a)
gg<-ggplot(data=privatenp,aes(x=costt4_a,y=debt_mdn,text=instnm))
gg<-gg+geom_point(alpha=.5,size=.5)
gg<-gg+xlab("Average Cost of Attendance")+ylab("Median Debt")
gg<-gg+ggtitle("Debt and Cost in Private Non-Profit Universities")
gg
gg_privatenp <-gg
```

The scatterplot also shows a positive relationship between average cost of attendance and median debt. It's important to note that many of the private non-profit schools have an average cost of attendance of around 50k. And, among this tightly grouped schools, there is a wide range of median debt. 

The following code is used the generate the last plot, showing the relationship between median debt and average cost in eight private for-profit schools. This visual is saved as gg_privateprof for later use.
```{r}
sc%>%filter(control=="3")%>%
  select(instnm,costt4_a,debt_mdn)%>%arrange(-costt4_a)
privateprof <- sc%>%filter(control=="3")%>%select(instnm,debt_mdn,costt4_a)
gg<-ggplot(data=privateprof,aes(x=costt4_a,y=debt_mdn,text=instnm))
gg<-gg+geom_point(alpha=.5,size=.5)
gg<-gg+xlab("Average Cost of Attendance")+ylab("Median Debt")
gg<-gg+ggtitle("Debt and Cost in Private For-Profit Universities")
gg
gg_privateprof <-gg
```